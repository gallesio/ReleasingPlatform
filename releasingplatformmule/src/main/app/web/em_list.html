<!DOCTYPE>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		
		<title>Entity Manager</title>
		
		<!-- Bootstrap core CSS -->
		<link href="./bootstrap/css/bootstrap.min.css" type="text/css"
			rel="stylesheet">
		<!-- Custom styles for this template -->
		<link href="dashboard.css" type="text/css" rel="stylesheet">
	</head>
	<body>

		<!-- Static navigation header bar -->
		<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
			<div class="container-fluid">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse"
						data-target=".navbar-collapse">
						<span class="sr-only">Toggle navigation</span> <span
							class="icon-bar"></span> <span class="icon-bar"></span> <span
							class="icon-bar"></span>
					</button>
					<a class="navbar-brand" href="#"> Releasing Manager </a>
				</div>
			</div>
		</div>
	

		<div class="container-fluid">
			<div class="row">
	
				<!-- Static navigation side bar -->
				<div class="col-sm-3 col-md-2 sidebar">
					<ul class="nav nav-sidebar">
						<li class="active"><a href="http://localhost:8081/em/l">Entity Manager</a></li>
						<li><a href="http://localhost:8081/cm">Change Manager</a></li>
						<li><a href="http://localhost:8081/rm">Release Manager</a></li>
						<li><a href="http://localhost:8081/rcm">Release Construction Manager</a></li>
					</ul>
				</div>


				<!-- Dynamic content -->
				<div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
					<h1 class="page-header">Entity Manager</h1>
	
					<ul class="nav nav-tabs">
						<li id="list_li"><a href="http://localhost:8081/em/l" id="list_ref"><span
								class="glyphicon glyphicon-list"></span> List all components</a></li>
						<li id="create_li"><a href="http://localhost:8081/em/l" id="create_ref"><span class="glyphicon glyphicon-plus"></span>
								Create a component</a></li>
						<li id="find_li"><a href="http://localhost:8081/em/l" id="find_ref"><span class="glyphicon glyphicon-search"></span>
								Find/view a component</a></li>
					</ul>
	
					<br />
	
					<!-- Content for list form -->
					<div class="panel panel-default"
						style="padding: 15px; border-style: none"
						id="list_div">
						<form class="form-horizontal" method="GET" id="listForm"
							action="http://localhost:8081/list">
							<button type="submit" class="btn">List all the components</button>
							<div id="list_resp" class="modal-body" style="display: none;"></div>
	
							<div class="table-responsive">
								<table id="list_table" class="table table-striped">
									<thead>
										<th>Comp_id</th>
										<th>Name</th>
										<th>Type</th>
										<th>Ref</th>
									</thead>
									<tbody>
									</tbody>
								</table>
							</div>
						</form>
					</div>
					
					<!-- Content for create form -->
					<div class="panel panel-default"
						style="padding: 15px; border-style: none"
						id="create_div">
						
						<form class="form-horizontal" method="GET" id="createForm" 
							action="http://localhost:8081/create">
	        				<input type="text" id="name" value="component1"></input>
	        				<input type="text" id="type" value="java"></input>
	        				<input type="text" id="ref"  value="github"></input>
	        				<div id="create_resp" class="modal-body" style="display: none;"></div>
	          				<button type="submit" class="btn">Create a new component</button>
						</form>
					</div>

					<!-- Content for find form -->
					<div class="panel panel-default"
						style="padding: 15px; border-style: none"
						id="find_div">
						
						<form class="form-horizontal" method="GET" id="findForm" 
							action="http://localhost:8081/find">
	        				<input type="text" id="comp_id" name="comp_id" value="50"></input>
	        				<div id="find_resp" class="modal-body" style="display: none;"></div>
	          				<button type="submit" class="btn">Find a component</button>
	          			</form>
					</div>
				</div>
			</div>
		</div>


		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="jquery.jsonserialize.js"></script>
		<script type="text/javascript" src="./dynatable/jquery.dynatable.js"></script>

		<script type="text/javascript">
			$(document).ready(function(){

				// List form script
				$('#listForm').submit(function(event) {
			    	event.preventDefault();
			    
			    	var $form = $(this),
				        url = $form.attr("action"),
				        $list_resp = $('#list_resp');
			    
				    $.ajax({
				    	url: url,
				    	type: "GET"
				    })
					    
				    .done(function (resp) {
		  				var list_resp_json = JSON.stringify(resp);
				    	$list_resp.show().text(list_resp_json);
				        $list_resp.hide();
		      
				      	var $response = $('#list_resp'),
				      		myResponse = JSON.parse($response.text()),
				      		$resp_j = $response.text();
		      
				        $('#list_table').dynatable({
				  			dataset: {
				  				records: myResponse
				  			}
				  		});
		    		});
				});

				// Create form script
				$('#createForm').submit(function(event) {
		            event.preventDefault();
		            
		            var $form = $(this),
			            url = $form.attr("action"),
			            variable = $form.serializeJSON(),
			            json = JSON.stringify(variable),
			            name_value = document.getElementById('name').value,
			            type_value = document.getElementById('type').value,
			            ref_value  = document.getElementById('ref').value;
		            
		            $.ajax({
		            	url: url,
		            		type: "GET",
		            		data: { name: name_value,
		            				type: type_value,
		           					ref: ref_value
		            			  },
		            })

		            .done(function(resp) {
		            	$('#create_resp').text(JSON.stringify(resp));
		            });

		        });

				// Find form script
	          	$('#findForm').submit(function(event) {
	            	event.preventDefault();
	            
					var $form = $(this),
						url = $form.attr("action"),
						variable = $form.serializeJSON(),
						json = JSON.stringify(variable),
						id_value = document.getElementById('comp_id').value;
	            
					$.ajax({
						url: url,
						type: "GET",
						data: { id: id_value }
					})

					.done(function(resp) {
						$('#find_resp').text(JSON.stringify(resp));
					});
				});

	          	// Hide/show content respecting with list/create/find
	          	/* $('#list_ref').click(function() {
					// unable the other tabs and active the current one
					$('#create_li').removeClass('active');
					$('#find_li').removeClass('active');
					$('#list_li').addClass('active');
					// hide the other div and show the current one
					$('#create_div').hide();
					$('#find_div').hide();
					$('#list_div').show();
				});
				$('#create_ref').click(function() {
					// unable the other tabs and active the current one
					$('#list_li').removeClass('active');
					$('#find_li').removeClass('active');
					$('#create_li').addClass('active');
					// hide the other div and show the current one
					$('#list_div').hide();
					$('#find_div').hide();
					$('#create_div').show();
				});
				$('#find_ref').click(function() {
					// unable the other tabs and active the current one
					$('#list_li').removeClass('active');
					$('#create_li').removeClass('active');
					$('#find_li').addClass('active');
					// hide the other div and show the current one
					$('#list_div').hide();
					$('#create_div').hide();
					$('#find_div').show();
				}); */
			});
		</script>


	</body>
</html>
